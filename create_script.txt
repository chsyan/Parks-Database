CREATE TABLE National_Park
  	(name char(30) PRIMARY KEY,
	address char(50) UNIQUE NOT NULL,
	phone_number Bigint UNIQUE NOT NULL);

CREATE TABLE Management
	(id char(30) PRIMARY KEY,
	name char(30) NOT NULL,
    password varchar(20) NOT NULL);

CREATE TABLE Keyword
	(word char(30) PRIMARY KEY);

CREATE TABLE Visitor
	(email char(30) PRIMARY KEY,
	name char(30) NOT NULL,
	phone_num Bigint UNIQUE NOT NULL,
    password varchar(20) NOT NULL);

CREATE TABLE Attraction
	(attraction_name char(30) PRIMARY KEY,
	is_active Bigint NOT NULL,
	season char(30) NOT NULL);

CREATE TABLE Scenery_Form_Manmade
	(form char(30) PRIMARY KEY,
	manmade Bigint NOT NULL);

CREATE TABLE NP_Has_Keyword
(word char(30),
	np_name char(30),
	PRIMARY KEY(word, np_name),
	FOREIGN KEY(np_name) REFERENCES National_Park(name)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    FOREIGN KEY(word) REFERENCES Keyword(word)
        ON DELETE CASCADE
        ON UPDATE CASCADE);

CREATE TABLE Activity
	(id char(30) PRIMARY KEY,
	capacity Bigint NOT NULL,
	activity_name char(30) NOT NULL,
	price real NOT NULL,
    np_name char(30) NOT NULL,
    FOREIGN KEY (np_name) REFERENCES National_Park(name)
        ON DELETE CASCADE
        ON UPDATE CASCADE);

CREATE TABLE Books_Activity_Amount
	(activity_id char(30),
	num_people Bigint NOT NULL,
	amount_paid real NOT NULL,
    visitor_email char(30),
	PRIMARY KEY(activity_id, visitor_email),
	FOREIGN KEY(activity_id) REFERENCES Activity(id)
        ON DELETE NO ACTION
        ON UPDATE NO ACTION,
    FOREIGN KEY(visitor_email) REFERENCES Visitor(email)
        ON DELETE NO ACTION
        ON UPDATE CASCADE);

CREATE TABLE Books_Reservation_ID
	(id char(30) PRIMARY KEY,
activity_id char(30) NOT NULL,
	date date NOT NULL ,
	visitor_email char(30) NOT NULL,
	num_people Bigint NOT NULL,
	FOREIGN KEY(activity_id) REFERENCES Activity(id)
ON DELETE NO ACTION
ON UPDATE NO ACTION,
FOREIGN KEY(visitor_email) REFERENCES Visitor(email)
ON DELETE NO ACTION
ON UPDATE CASCADE);


CREATE TABLE Cancels_Reservation
	(reservation_id char(30),
	management_id char(30),
	PRIMARY KEY(reservation_id, management_id),
	FOREIGN KEY(reservation_id) REFERENCES Books_Reservation_ID(id)
		ON DELETE NO ACTION
		ON UPDATE CASCADE,
	FOREIGN KEY(management_id) REFERENCES Management(id)
		ON DELETE NO ACTION
		ON UPDATE CASCADE);

CREATE TABLE Request_Cancel
	(reservaton_id char(30) NOT NULL,
	management_id char(30),
	visitor_email char(30),
	PRIMARY KEY(visitor_email, management_id),
	FOREIGN KEY(visitor_email) REFERENCES Visitor(email)
		ON DELETE CASCADE
		ON UPDATE CASCADE,
	FOREIGN KEY(management_id) REFERENCES Management(id)
		ON DELETE CASCADE
		ON UPDATE CASCADE);

CREATE TABLE NP_Rating_Stars
	(visitor_email char(30),
              np_name char(30),
              stars real NOT NULL,
              comment char(60),
              PRIMARY KEY(visitor_email, np_name),
              FOREIGN KEY (visitor_email) REFERENCES Visitor(email)
                          ON DELETE NO ACTION
                          ON UPDATE CASCADE,
            FOREIGN KEY (np_name) REFERENCES National_Park(name)
                         ON DELETE NO ACTION
                         ON UPDATE CASCADE);

CREATE TABLE NP_Rating_ID
	(rating_ID char(30) PRIMARY KEY,
visitor_email char(30) NOT NULL ,
np_name char(30) NOT NULL,
FOREIGN KEY (np_name) REFERENCES National_Park(name)
ON DELETE CASCADE
ON UPDATE CASCADE,
FOREIGN KEY (visitor_email) REFERENCES Visitor(email)
ON DELETE NO ACTION
ON UPDATE CASCADE);

CREATE TABLE NP_Contains_Attraction
             (attraction_name char(30),
             np_name               char(30),
             location                 char(30),
            PRIMARY KEY (attraction_name, np_name),
            FOREIGN KEY (attraction_name) REFERENCES Attraction(attraction_name)
                          ON DELETE CASCADE
                          ON UPDATE CASCADE,
            FOREIGN KEY (np_name) REFERENCES National_Park(name)
                          ON DELETE CASCADE
                          ON UPDATE CASCADE);

CREATE TABLE Wildlife
	(attraction_name char(30) PRIMARY KEY,
	species_name char(30) UNIQUE NOT NULL,
	type char(30) NOT NULL,
	FOREIGN KEY(attraction_name) REFERENCES Attraction(attraction_name)
		ON DELETE CASCADE
		ON UPDATE CASCADE);

CREATE TABLE Scenery_Attraction_Name
	(attraction_name char(30) PRIMARY KEY,
	form char(30) NOT NULL,
	FOREIGN KEY(attraction_name) REFERENCES Attraction(attraction_name)
		ON DELETE CASCADE
		ON UPDATE CASCADE,
FOREIGN KEY(form) REFERENCES Scenery_Form_Manmade(form)
ON DELETE NO ACTION
ON UPDATE CASCADE);

CREATE TABLE Attraction_Has_Keyword
	(word char(30),
	attraction_name char(30),
	PRIMARY KEY(word, attraction_name),
	FOREIGN KEY(attraction_name) REFERENCES Attraction(attraction_name)
ON DELETE CASCADE
ON UPDATE CASCADE,
FOREIGN KEY(word) REFERENCES Keyword(word)
ON DELETE CASCADE
ON UPDATE CASCADE);

CREATE TABLE Activity_Has_Keyword
	(word char(30),
	activity_id char(30),
	PRIMARY KEY(word, activity_id),
	FOREIGN KEY(activity_id) REFERENCES Activity(id)
ON DELETE CASCADE
ON UPDATE CASCADE,
FOREIGN KEY(word) REFERENCES Keyword(word)
ON DELETE CASCADE
ON UPDATE CASCADE);

CREATE TABLE Popularity_Record
	(activity_id char(30),
	start_date date,
	end_date date,
	num_visitors Bigint NOT NULL,
	PRIMARY KEY(activity_id, start_date, end_date),
	FOREIGN KEY(activity_id) REFERENCES Activity(id)
		ON DELETE CASCADE
		ON UPDATE CASCADE);